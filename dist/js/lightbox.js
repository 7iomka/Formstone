/*! formstone v1.0.1 [lightbox.js] 2016-04-02 | MIT License | formstone.it */

!function(a){"function"==typeof define&&define.amd?define(["jquery","./core","./touch","./transition"],a):a(jQuery,Formstone)}(function(a,b){"use strict";function c(){aa=b.$body,ba=a("html, body"),ca=b.window.location.hash.replace("#","")}function d(){ea&&i()}function e(a){this.on(Y.click,a,h);var b=this.data(U+"-gallery");!da&&ca&&b===ca&&(da=!0,this.trigger(Y.click))}function f(){j(),this.off(Y.namespace)}function g(b,c){b instanceof a&&h.apply($,[{data:a.extend(!0,{},{$object:b},V,c||{})}])}function h(c){if(!ea){var d=c.data;ea=a.extend({},{visible:!1,gallery:{active:!1},isMobile:b.isMobile||d.mobile,isTouch:b.support.touch,isAnimating:!0,oldContentHeight:0,oldContentWidth:0,captionOpen:!1,thumbnailsOpen:!1},d);var e=d.$el,f=d.$object,g=e&&e[0].href?e[0].href||"":"",h=e&&e[0].hash?e[0].hash||"":"",i=(g.toLowerCase().split(".").pop().split(/\#|\?/),e?e.data(U+"-type"):""),k="image"===i||g.match(d.fileTypes)||"data:image"===g.substr(0,10),l=S(g),n="url"===i||!k&&!l&&"http"===g.substr(0,4)&&!h,p="element"===i||!k&&!l&&!n&&"#"===h.substr(0,1),q="undefined"!=typeof f;if(p&&(g=h),!(k||l||n||p||q))return void(ea=null);if(Z.killEvent(c),ea.touch=d.touch&&ea.isMobile&&ea.isTouch,ea.margin*=2,ea.type=k?"image":l?"video":"element",k||l){var s=e.data(U+"-gallery");s&&(ea.gallery.active=!0,ea.gallery.id=s,ea.gallery.$items=a("a[data-lightbox-gallery= "+ea.gallery.id+"], a[rel= "+ea.gallery.id+"]"),ea.gallery.index=ea.gallery.$items.index(ea.$el),ea.gallery.total=ea.gallery.$items.length-1)}ea.thumbnails&&(k||l)&&ea.gallery.active||(ea.thumbnails=!1);var u="";ea.isMobile||(u+='<div class="'+[X.overlay,ea.theme,ea.customClass].join(" ")+'"></div>');var v=[X.base,X.loading,X.animating,ea.theme,ea.customClass];if(ea.fixed&&v.push(X.fixed),ea.isMobile&&v.push(X.mobile),ea.isTouch&&v.push(X.touch),n&&v.push(X.iframed),(p||q)&&v.push(X.inline),ea.thumbnails&&v.push(X.thumbnailed),u+='<div class="'+v.join(" ")+'">',u+='<button type="button" class="'+X.close+'">'+ea.labels.close+"</button>",u+='<span class="'+X.loading_icon+'"></span>',u+='<div class="'+X.container+'">',ea.gallery.active&&ea.thumbnails){u+='<div class="'+[X.thumbnails]+'">',u+='<div class="'+[X.thumbnail_container]+'">';for(var w,x,y=0,z=ea.gallery.$items.length;z>y;y++)w=ea.gallery.$items.eq(y),x=w.data("lightbox-thumbnail"),x||(x=w.find("img").attr("src")),u+='<button class="'+[X.thumbnail_item]+'">',u+='<img src="'+x+'" alt="">',u+="</button>";u+="</div></div>"}u+='<div class="'+X.content+'"></div>',(k||l)&&(u+='<div class="'+X.tools+'">',u+='<div class="'+X.controls+'">',ea.gallery.active&&(u+='<button type="button" class="'+[X.control,X.control_previous].join(" ")+'">'+ea.labels.previous+"</button>",u+='<button type="button" class="'+[X.control,X.control_next].join(" ")+'">'+ea.labels.next+"</button>"),ea.isMobile&&ea.isTouch&&(u+='<button type="button" class="'+[X.toggle,X.caption_toggle].join(" ")+'">'+ea.labels.captionClosed+"</button>",ea.gallery.active&&ea.thumbnails&&(u+='<button type="button" class="'+[X.toggle,X.thumbnail_toggle].join(" ")+'">'+ea.labels.thumbnailsClosed+"</button>")),u+="</div>",u+='<div class="'+X.meta+'">',u+='<div class="'+X.meta_content+'">',ea.gallery.active&&(u+='<p class="'+X.position+'"',ea.gallery.total<1&&(u+=' style="display: none;"'),u+=">",u+='<span class="'+X.position_current+'">'+(ea.gallery.index+1)+"</span> ",u+=ea.labels.count,u+=' <span class="'+X.position_total+'">'+(ea.gallery.total+1)+"</span>",u+="</p>"),u+='<div class="'+X.caption+'">',u+=ea.formatter.call(e,d),u+="</div></div></div>",u+="</div>"),u+="</div></div>",aa.append(u),ea.$overlay=a(W.overlay),ea.$lightbox=a(W.base),ea.$close=a(W.close),ea.$container=a(W.container),ea.$content=a(W.content),ea.$tools=a(W.tools),ea.$meta=a(W.meta),ea.$metaContent=a(W.meta_content),ea.$position=a(W.position),ea.$caption=a(W.caption),ea.$controlBox=a(W.controls),ea.$controls=a(W.control),ea.$thumbnails=a(W.thumbnails),ea.$thumbnailContainer=a(W.thumbnail_container),ea.$thumbnailItems=a(W.thumbnail_item),ea.isMobile?(ea.paddingVertical=ea.$close.outerHeight(),ea.paddingHorizontal=0,ea.mobilePaddingVertical=parseInt(ea.$content.css("paddingTop"),10)+parseInt(ea.$content.css("paddingBottom"),10),ea.mobilePaddingHorizontal=parseInt(ea.$content.css("paddingLeft"),10)+parseInt(ea.$content.css("paddingRight"),10)):(ea.paddingVertical=parseInt(ea.$lightbox.css("paddingTop"),10)+parseInt(ea.$lightbox.css("paddingBottom"),10),ea.paddingHorizontal=parseInt(ea.$lightbox.css("paddingLeft"),10)+parseInt(ea.$lightbox.css("paddingRight"),10),ea.mobilePaddingVertical=0,ea.mobilePaddingHorizontal=0),ea.contentHeight=ea.$lightbox.outerHeight()-ea.paddingVertical,ea.contentWidth=ea.$lightbox.outerWidth()-ea.paddingHorizontal,ea.controlHeight=ea.$controls.outerHeight(),m(),ea.gallery.active&&(ea.$lightbox.addClass(X.has_controls),J()),_.on(Y.keyDown,K),aa.on(Y.click,[W.overlay,W.close].join(", "),j),ea.gallery.active&&ea.$lightbox.on(Y.click,W.control,G),ea.thumbnails&&ea.$lightbox.on(Y.click,W.thumbnail_item,H),ea.isMobile&&ea.isTouch&&ea.$lightbox.on(Y.click,W.caption_toggle,o).on(Y.click,W.thumbnail_toggle,r),ea.$lightbox.fsTransition({property:"opacity"},function(){k?t(g):l?D(g):n?N(g):p?L(g):q&&O(ea.$object)}).addClass(X.open),ea.$overlay.addClass(X.open)}}function i(a){"object"!=typeof a&&(ea.targetHeight=arguments[0],ea.targetWidth=arguments[1]),"element"===ea.type?P(ea.$content.find("> :first-child")):"image"===ea.type?z():"video"===ea.type&&E(),l()}function j(a){Z.killEvent(a),ea&&(ea.$lightbox.fsTransition("destroy"),ea.$container.fsTransition("destroy"),u(),ea.$lightbox.addClass(X.animating).fsTransition({property:"opacity"},function(){"undefined"!=typeof ea.$inlineTarget&&ea.$inlineTarget.length&&M(),ea.$lightbox.off(Y.namespace),ea.$container.off(Y.namespace),_.off(Y.keyDown),aa.off(Y.namespace),ea.$overlay.remove(),ea.$lightbox.remove(),ea=null,_.trigger(Y.close)}),ea.$lightbox.removeClass(X.open),ea.$overlay.removeClass(X.open),ea.isMobile&&ba.removeClass(X.lock))}function k(){{var a=n();ea.isMobile?0:ea.duration}ea.isMobile||ea.$controls.css({marginTop:(ea.contentHeight-ea.controlHeight-ea.metaHeight+ea.thumbnailHeight)/2}),ea.$lightbox.fsTransition({property:ea.contentHeight!==ea.oldContentHeight?"height":"width"},function(){ea.$container.fsTransition({property:"opacity"},function(){ea.$lightbox.removeClass(X.animating),ea.isAnimating=!1}),ea.$lightbox.removeClass(X.loading),ea.visible=!0,_.trigger(Y.open),ea.gallery.active&&F()}),ea.isMobile||ea.$lightbox.css({height:ea.contentHeight+ea.paddingVertical,width:ea.contentWidth+ea.paddingHorizontal,top:ea.fixed?0:a.top});var b=ea.oldContentHeight!==ea.contentHeight||ea.oldContentWidth!==ea.contentWidth;if((ea.isMobile||!b)&&ea.$lightbox.fsTransition("resolve"),ea.oldContentHeight=ea.contentHeight,ea.oldContentWidth=ea.contentWidth,ea.isMobile&&ba.addClass(X.lock),ea.thumbnails){var c=ea.$thumbnailItems.eq(ea.gallery.index),d=c.position().left+c.outerWidth(!1)/2-ea.$thumbnailContainer.outerWidth(!0)/2;ea.$thumbnailItems.removeClass(X.active),c.addClass(X.active),ea.$thumbnailContainer.scrollLeft(d)}}function l(){if(ea.visible&&!ea.isMobile){var a=n();ea.$controls.css({marginTop:(ea.contentHeight-ea.controlHeight-ea.metaHeight+ea.thumbnailHeight)/2}),ea.$lightbox.css({height:ea.contentHeight+ea.paddingVertical,width:ea.contentWidth+ea.paddingHorizontal,top:ea.fixed?0:a.top})}}function m(){var a=n();ea.$lightbox.css({top:ea.fixed?0:a.top})}function n(){if(ea.isMobile)return{left:0,top:0};var a={left:(b.windowWidth-ea.contentWidth-ea.paddingHorizontal)/2,top:ea.top<=0?(b.windowHeight-ea.contentHeight-ea.paddingVertical)/2:ea.top};return ea.fixed!==!0&&(a.top+=_.scrollTop()),a}function o(a){if(Z.killEvent(a),ea.captionOpen)p();else{s();var b=parseInt(ea.$metaContent.outerHeight(!0));b+=parseInt(ea.$meta.css("padding-top")),b+=parseInt(ea.$meta.css("padding-bottom")),ea.$meta.css({height:b}),ea.$lightbox.addClass(X.caption_open).find(W.caption_toggle).text(ea.labels.captionOpen),ea.captionOpen=!0}}function p(){ea.$lightbox.removeClass(X.caption_open).find(W.caption_toggle).text(ea.labels.captionClosed),ea.captionOpen=!1}function q(){var a=this.attr("title"),b=void 0!==a&&a?a.replace(/^\s+|\s+$/g,""):!1;return b?'<p class="caption">'+b+"</p>":""}function r(a){Z.killEvent(a),ea.thumbnailsOpen?s():(p(),ea.$lightbox.addClass(X.thumbnails_open).find(W.thumbnail_toggle).text(ea.labels.thumbnailsOpen),ea.thumbnailsOpen=!0)}function s(){ea.$lightbox.removeClass(X.thumbnails_open).find(W.thumbnail_toggle).text(ea.labels.thumbnailsClosed),ea.thumbnailsOpen=!1}function t(b){ea.hasScaled=!1,ea.$imageContainer=a('<div class="'+X.image_container+'"><img></div>'),ea.$image=ea.$imageContainer.find("img"),ea.$image.one(Y.load,function(){var a=R(ea.$image);ea.naturalHeight=a.naturalHeight,ea.naturalWidth=a.naturalWidth,ea.retina&&(ea.naturalHeight/=2,ea.naturalWidth/=2),ea.$content.prepend(ea.$imageContainer),""===ea.$caption.html()?(ea.$caption.hide(),ea.$lightbox.removeClass(X.has_caption)):(ea.$caption.show(),ea.$lightbox.addClass(X.has_caption)),z(),k(),ea.touch&&(v(),x({scale:1,deltaX:0,deltaY:0}),y(),ea.$content.fsTouch({pan:!0,scale:!0}).on(Y.scaleStart,w).on(Y.scaleEnd,y).on(Y.scale,x))}).error(Q).attr("src",b).addClass(X.image),(ea.$image[0].complete||4===ea.$image[0].readyState)&&ea.$image.trigger(Y.load)}function u(){ea.$image&&ea.$image.length&&ea.$content.fsTouch("destroy")}function v(){ea.scalePosition=ea.$imageContainer.position(),ea.scaleY=ea.scalePosition.top,ea.scaleX=ea.scalePosition.left,ea.scaleHeight=ea.$image.outerHeight(),ea.scaleWidth=ea.$image.outerWidth()}function w(){v(),ea.$lightbox.removeClass(X.animating)}function x(a){ea.targetContainerY=ea.scaleY+a.deltaY,ea.targetContainerX=ea.scaleX+a.deltaX,ea.targetImageHeight=ea.scaleHeight*a.scale,ea.targetImageWidth=ea.scaleWidth*a.scale,ea.targetImageHeight<ea.scaleMinHeight&&(ea.targetImageHeight=ea.scaleMinHeight),ea.targetImageHeight>ea.scaleMaxHeight&&(ea.targetImageHeight=ea.scaleMaxHeight),ea.targetImageWidth<ea.scaleMinWidth&&(ea.targetImageWidth=ea.scaleMinWidth),ea.targetImageWidth>ea.scaleMaxWidth&&(ea.targetImageWidth=ea.scaleMaxWidth),ea.hasScaled=!0,ea.isScaling=!0,ea.$imageContainer.css({top:ea.targetContainerY,left:ea.targetContainerX}),ea.$image.css({height:ea.targetImageHeight,width:ea.targetImageWidth,top:-(ea.targetImageHeight/2),left:-(ea.targetImageWidth/2)})}function y(){v(),ea.isScaling=!1;var a=ea.$container.outerHeight()-ea.metaHeight,b=ea.$container.outerWidth();ea.scaleMinY=a-ea.scaleHeight/2,ea.scaleMinX=b-ea.scaleWidth/2,ea.scaleMaxY=ea.scaleHeight/2,ea.scaleMaxX=ea.scaleWidth/2,ea.scaleHeight<a?ea.scalePosition.top=a/2:(ea.scalePosition.top<ea.scaleMinY&&(ea.scalePosition.top=ea.scaleMinY),ea.scalePosition.top>ea.scaleMaxY&&(ea.scalePosition.top=ea.scaleMaxY)),ea.scaleWidth<b?ea.scalePosition.left=b/2:(ea.scalePosition.left<ea.scaleMinX&&(ea.scalePosition.left=ea.scaleMinX),ea.scalePosition.left>ea.scaleMaxX&&(ea.scalePosition.left=ea.scaleMaxX)),ea.$lightbox.addClass(X.animating),ea.$imageContainer.css({left:ea.scalePosition.left,top:ea.scalePosition.top})}function z(){if(ea.$image){var a=0;for(ea.windowHeight=ea.viewportHeight=b.windowHeight-ea.mobilePaddingVertical-ea.paddingVertical,ea.windowWidth=ea.viewportWidth=b.windowWidth-ea.mobilePaddingHorizontal-ea.paddingHorizontal,ea.contentHeight=1/0,ea.contentWidth=1/0,ea.imageMarginTop=0,ea.imageMarginLeft=0;ea.contentHeight>ea.viewportHeight&&2>a;)ea.imageHeight=0===a?ea.naturalHeight:ea.$image.outerHeight(),ea.imageWidth=0===a?ea.naturalWidth:ea.$image.outerWidth(),ea.metaHeight=0===a?0:ea.metaHeight,ea.spacerHeight=0===a?0:ea.spacerHeight,ea.thumbnailHeight=0===a?0:ea.thumbnailHeight,0===a&&(ea.ratioHorizontal=ea.imageHeight/ea.imageWidth,ea.ratioVertical=ea.imageWidth/ea.imageHeight,ea.isWide=ea.imageWidth>ea.imageHeight),ea.imageHeight<ea.minHeight&&(ea.minHeight=ea.imageHeight),ea.imageWidth<ea.minWidth&&(ea.minWidth=ea.imageWidth),ea.isMobile?(ea.isTouch?(ea.$controlBox.css({width:b.windowWidth}),ea.spacerHeight=ea.$controls.outerHeight(!0)):(ea.$tools.css({width:b.windowWidth}),ea.spacerHeight=ea.$tools.outerHeight(!0)),ea.spacerHeight+=ea.$thumbnails.outerHeight(!0)+10,ea.contentHeight=ea.viewportHeight,ea.contentWidth=ea.viewportWidth,A(),ea.imageMarginTop=(ea.contentHeight-ea.targetImageHeight-ea.spacerHeight)/2,ea.imageMarginLeft=(ea.contentWidth-ea.targetImageWidth)/2):(0===a&&(ea.viewportHeight-=ea.margin+ea.paddingVertical,ea.viewportWidth-=ea.margin+ea.paddingHorizontal),ea.viewportHeight-=ea.metaHeight,ea.thumbnails&&(ea.viewportHeight-=ea.thumbnailHeight),A(),ea.contentHeight=ea.targetImageHeight,ea.contentWidth=ea.targetImageWidth),ea.isMobile||ea.isTouch||ea.$meta.css({width:ea.contentWidth}),ea.hasScaled||(ea.$image.css({height:ea.targetImageHeight,width:ea.targetImageWidth}),ea.$image.css(ea.touch?{top:-(ea.targetImageHeight/2),left:-(ea.targetImageWidth/2)}:{marginTop:ea.imageMarginTop,marginLeft:ea.imageMarginLeft})),ea.isMobile||(ea.metaHeight=ea.$meta.outerHeight(!0),ea.contentHeight+=ea.metaHeight),ea.thumbnails&&(ea.thumbnailHeight=ea.$thumbnails.outerHeight(!0),ea.contentHeight+=ea.thumbnailHeight),a++;ea.touch&&(ea.scaleMinHeight=ea.targetImageHeight,ea.scaleMinWidth=ea.targetImageWidth,ea.scaleMaxHeight=ea.naturalHeight,ea.scaleMaxWidth=ea.naturalWidth)}}function A(){var a=ea.isMobile?ea.contentHeight-ea.spacerHeight:ea.viewportHeight,b=ea.isMobile?ea.contentWidth:ea.viewportWidth;ea.isWide?(ea.targetImageWidth=b,ea.targetImageHeight=ea.targetImageWidth*ea.ratioHorizontal,ea.targetImageHeight>a&&(ea.targetImageHeight=a,ea.targetImageWidth=ea.targetImageHeight*ea.ratioVertical)):(ea.targetImageHeight=a,ea.targetImageWidth=ea.targetImageHeight*ea.ratioVertical,ea.targetImageWidth>b&&(ea.targetImageWidth=b,ea.targetImageHeight=ea.targetImageWidth*ea.ratioHorizontal)),(ea.targetImageWidth>ea.imageWidth||ea.targetImageHeight>ea.imageHeight)&&(ea.targetImageHeight=ea.imageHeight,ea.targetImageWidth=ea.imageWidth),(ea.targetImageWidth<ea.minWidth||ea.targetImageHeight<ea.minHeight)&&(ea.targetImageWidth<ea.minWidth?(ea.targetImageWidth=ea.minWidth,ea.targetImageHeight=ea.targetImageWidth*ea.ratioHorizontal):(ea.targetImageHeight=ea.minHeight,ea.targetImageWidth=ea.targetImageHeight*ea.ratioVertical))}function B(a){return"//www.youtube.com/embed/"+a[1]}function C(a){return"//player.vimeo.com/video/"+a[3]}function D(b){var c=S(b),d=b.split("?");c?(d.length>=2&&(c+="?"+d.slice(1)[0].trim()),ea.$videoWrapper=a('<div class="'+X.video_wrapper+'"></div>'),ea.$video=a('<iframe class="'+X.video+'" frameborder="0" seamless="seamless" allowfullscreen></iframe>'),ea.$video.attr("src",c).addClass(X.video).prependTo(ea.$videoWrapper),ea.$content.prepend(ea.$videoWrapper),E(),k()):Q()}function E(){ea.windowHeight=ea.viewportHeight=b.windowHeight-ea.mobilePaddingVertical-ea.paddingVertical,ea.windowWidth=ea.viewportWidth=b.windowWidth-ea.mobilePaddingHorizontal-ea.paddingHorizontal,ea.videoMarginTop=0,ea.videoMarginLeft=0,ea.isMobile?(ea.isTouch?(ea.$controlBox.css({width:b.windowWidth}),ea.spacerHeight=ea.$controls.outerHeight(!0)):(ea.$tools.css({width:b.windowWidth}),ea.spacerHeight=ea.$tools.outerHeight(!0)),ea.spacerHeight=ea.$thumbnails.outerHeight(!0)+10,ea.viewportHeight-=ea.spacerHeight,ea.targetVideoWidth=ea.viewportWidth,ea.targetVideoHeight=ea.targetVideoWidth*ea.videoRatio,ea.targetVideoHeight>ea.viewportHeight&&(ea.targetVideoHeight=ea.viewportHeight,ea.targetVideoWidth=ea.targetVideoHeight/ea.videoRatio),ea.videoMarginTop=(ea.viewportHeight-ea.targetVideoHeight)/2,ea.videoMarginLeft=(ea.viewportWidth-ea.targetVideoWidth)/2):(ea.viewportHeight=ea.windowHeight-ea.margin,ea.viewportWidth=ea.windowWidth-ea.margin,ea.targetVideoWidth=ea.videoWidth>ea.viewportWidth?ea.viewportWidth:ea.videoWidth,ea.targetVideoWidth<ea.minWidth&&(ea.targetVideoWidth=ea.minWidth),ea.targetVideoHeight=ea.targetVideoWidth*ea.videoRatio,ea.contentHeight=ea.targetVideoHeight,ea.contentWidth=ea.targetVideoWidth),ea.isMobile||ea.isTouch||ea.$meta.css({width:ea.contentWidth}),ea.$videoWrapper.css({height:ea.targetVideoHeight,width:ea.targetVideoWidth,marginTop:ea.videoMarginTop,marginLeft:ea.videoMarginLeft}),ea.isMobile||(ea.metaHeight=ea.$meta.outerHeight(!0),ea.contentHeight+=ea.metaHeight),ea.thumbnails&&(ea.thumbnailHeight=ea.$thumbnails.outerHeight(!0),ea.contentHeight+=ea.thumbnailHeight)}function F(){var b="";ea.gallery.index>0&&(b=ea.gallery.$items.eq(ea.gallery.index-1).attr("href"),S(b)||a('<img src="'+b+'">')),ea.gallery.index<ea.gallery.total&&(b=ea.gallery.$items.eq(ea.gallery.index+1).attr("href"),S(b)||a('<img src="'+b+'">'))}function G(b){Z.killEvent(b);var c=a(b.currentTarget);ea.isAnimating||c.hasClass(X.control_disabled)||(ea.isAnimating=!0,u(),p(),ea.gallery.index+=c.hasClass(X.control_next)?1:-1,ea.gallery.index>ea.gallery.total&&(ea.gallery.index=ea.infinite?0:ea.gallery.total),ea.gallery.index<0&&(ea.gallery.index=ea.infinite?ea.gallery.total:0),ea.$lightbox.addClass(X.animating),ea.$container.fsTransition({property:"opacity"},I),ea.$lightbox.addClass(X.loading))}function H(b){Z.killEvent(b);var c=a(b.currentTarget);ea.isAnimating||c.hasClass(X.active)||(ea.isAnimating=!0,u(),p(),ea.gallery.index=ea.$thumbnailItems.index(c),ea.$lightbox.addClass(X.animating),ea.$container.fsTransition({property:"opacity"},I),ea.$lightbox.addClass(X.loading))}function I(){"undefined"!=typeof ea.$imageContainer&&ea.$imageContainer.remove(),"undefined"!=typeof ea.$videoWrapper&&ea.$videoWrapper.remove(),ea.$el=ea.gallery.$items.eq(ea.gallery.index),ea.$caption.html(ea.formatter.call(ea.$el,ea)),ea.$position.find(W.position_current).html(ea.gallery.index+1);var a=ea.$el.attr("href"),b=S(a);b?(ea.type="video",D(a)):(ea.type="image",t(a)),J()}function J(){ea.$controls.removeClass(X.control_disabled),ea.infinite||(0===ea.gallery.index&&ea.$controls.filter(W.control_previous).addClass(X.control_disabled),ea.gallery.index===ea.gallery.total&&ea.$controls.filter(W.control_next).addClass(X.control_disabled))}function K(a){!ea.gallery.active||37!==a.keyCode&&39!==a.keyCode?27===a.keyCode&&ea.$close.trigger(Y.click):(Z.killEvent(a),ea.$controls.filter(37===a.keyCode?W.control_previous:W.control_next).trigger(Y.click))}function L(b){ea.$inlineTarget=a(b),ea.$inlineContents=ea.$inlineTarget.children().detach(),O(ea.$inlineContents)}function M(){ea.$inlineTarget.append(ea.$inlineContents.detach())}function N(b){b+=b.indexOf("?")>-1?"&"+ea.requestKey+"=true":"?"+ea.requestKey+"=true";var c=a('<iframe class="'+X.iframe+'" src="'+b+'"></iframe>');O(c)}function O(a){ea.$content.append(a),P(a),k()}function P(a){ea.windowHeight=b.windowHeight-ea.mobilePaddingVertical-ea.paddingVertical,ea.windowWidth=b.windowWidth-ea.mobilePaddingHorizontal-ea.paddingHorizontal,ea.objectHeight=a.outerHeight(!0),ea.objectWidth=a.outerWidth(!0),ea.targetHeight=ea.targetHeight||(ea.$el?ea.$el.data(U+"-height"):null),ea.targetWidth=ea.targetWidth||(ea.$el?ea.$el.data(U+"-width"):null),ea.maxHeight=ea.windowHeight<0?ea.minHeight:ea.windowHeight,ea.isIframe=a.is("iframe"),ea.objectMarginTop=0,ea.objectMarginLeft=0,ea.isMobile||(ea.windowHeight-=ea.margin,ea.windowWidth-=ea.margin),ea.contentHeight=ea.targetHeight?ea.targetHeight:ea.isIframe||ea.isMobile?ea.windowHeight:ea.objectHeight,ea.contentWidth=ea.targetWidth?ea.targetWidth:ea.isIframe||ea.isMobile?ea.windowWidth:ea.objectWidth,(ea.isIframe||ea.isObject)&&ea.isMobile?(ea.contentHeight=ea.windowHeight,ea.contentWidth=ea.windowWidth):ea.isObject&&(ea.contentHeight=ea.contentHeight>ea.windowHeight?ea.windowHeight:ea.contentHeight,ea.contentWidth=ea.contentWidth>ea.windowWidth?ea.windowWidth:ea.contentWidth),ea.isMobile||(ea.contentHeight>ea.maxHeight&&(ea.contentHeight=ea.maxHeight),ea.contentWidth>ea.maxWidth&&(ea.contentWidth=ea.maxWidth))}function Q(){var b=a('<div class="'+X.error+'"><p>Error Loading Resource</p></div>');ea.type="element",ea.$tools.remove(),ea.$image.off(Y.namespace),O(b)}function R(a){var b=a[0],c=new Image;return"undefined"!=typeof b.naturalHeight?{naturalHeight:b.naturalHeight,naturalWidth:b.naturalWidth}:"img"===b.tagName.toLowerCase()?(c.src=b.src,{naturalHeight:c.height,naturalWidth:c.width}):!1}function S(a){var b,c=ea.videoFormatter;for(var d in c)if(c.hasOwnProperty(d)&&(b=a.match(c[d].pattern),null!==b))return c[d].format.call(ea,b);return!1}var T=b.Plugin("lightbox",{widget:!0,defaults:{customClass:"",fileTypes:/\.(jpg|sjpg|jpeg|png|gif)$/i,fixed:!1,formatter:q,infinite:!1,labels:{close:"Close",count:"of",next:"Next",previous:"Previous",captionClosed:"View Caption",captionOpen:"Close Caption",thumbnailsClosed:"View Thumbnails",thumbnailsOpen:"Close Thumbnails"},margin:50,maxHeight:1e4,maxWidth:1e4,minHeight:100,minWidth:100,mobile:!1,retina:!1,requestKey:"fs-lightbox",theme:"fs-light",thumbnails:!1,top:0,touch:!0,videoFormatter:{youtube:{pattern:/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/,format:B},vimeo:{pattern:/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,format:C}},videoRatio:.5625,videoWidth:800},classes:["loading","animating","fixed","mobile","touch","inline","iframed","open","overlay","close","loading_icon","container","content","image","image_container","video","video_wrapper","tools","meta","meta_content","controls","control","control_previous","control_next","control_disabled","position","position_current","position_total","toggle","caption_toggle","caption","caption_open","thumbnailed","thumbnails_open","thumbnail_toggle","thumbnails","thumbnail_container","thumbnail_item","active","has_controls","has_caption","iframe","error","active","lock"],events:{open:"open",close:"close"},methods:{_setup:c,_construct:e,_destruct:f,_resize:d,resize:i},utilities:{_initialize:g,close:j}}),U=T.namespace,V=T.defaults,W=T.classes,X=W.raw,Y=T.events,Z=T.functions,$=b.window,_=b.$window,aa=null,ba=null,ca=!1,da=!1,ea=null});