/*! formstone v1.1.4 [lightbox.js] 2016-06-20 | GPL-3.0 License | formstone.it */

!function(a){"function"==typeof define&&define.amd?define(["jquery","./core","./touch","./transition"],a):a(jQuery,Formstone)}(function(a,b){"use strict";function c(){ea=b.$body,fa=a("html, body"),ga=b.window.location.hash.replace("#","")}function d(){ia&&i()}function e(a){this.on(_.click,a,h);var b=this.data(X+"-gallery");!ha&&ga&&b===ga&&(ha=!0,this.trigger(_.click))}function f(a){j(),this.off(_.namespace)}function g(b,c){b instanceof a&&h.apply(ba,[{data:a.extend(!0,{},{$object:b},Y,c||{})}])}function h(c){if(!ia){var d=c.data;ia=a.extend({},{visible:!1,gallery:{active:!1},isMobile:b.isMobile||d.mobile,isTouch:b.support.touch,isAnimating:!0,oldContentHeight:0,oldContentWidth:0,metaHeight:0,thumbnailHeight:0,captionOpen:!1,thumbnailsOpen:!1},d);var e=d.$el,f=d.$object,g=e&&e[0].href?e[0].href||"":"",h=e&&e[0].hash?e[0].hash||"":"",i=(g.toLowerCase().split(".").pop().split(/\#|\?/),e?e.data(X+"-type"):""),k="image"===i||g.match(d.fileTypes)||"data:image"===g.substr(0,10),l=U(g),n="url"===i||!k&&!l&&"http"===g.substr(0,4)&&!h,p="element"===i||!k&&!l&&!n&&"#"===h.substr(0,1),q="undefined"!=typeof f;if(p&&(g=h),!(k||l||n||p||q))return void(ia=null);if(aa.killEvent(c),ia.touch=d.touch&&ia.isMobile&&ia.isTouch,ia.margin*=2,k?ia.type="image":l?ia.type="video":ia.type="element",k||l){var s=e.data(X+"-gallery");s&&(ia.gallery.active=!0,ia.gallery.id=s,ia.gallery.$items=a("a[data-lightbox-gallery= "+ia.gallery.id+"], a[rel= "+ia.gallery.id+"]"),ia.gallery.index=ia.gallery.$items.index(ia.$el),ia.gallery.total=ia.gallery.$items.length-1)}ia.thumbnails&&(k||l)&&ia.gallery.active||(ia.thumbnails=!1);var u="";ia.isMobile||(u+='<div class="'+[$.overlay,ia.theme,ia.customClass].join(" ")+'"></div>');var v=[$.base,$.loading,$.animating,ia.theme,ia.customClass];if(ia.fixed&&v.push($.fixed),ia.isMobile&&v.push($.mobile),ia.isTouch&&v.push($.touch),n&&v.push($.iframed),(p||q)&&v.push($.inline),ia.thumbnails&&v.push($.thumbnailed),u+='<div class="'+v.join(" ")+'" role="dialog" aria-label="lightbox" tabindex="-1">',u+='<button type="button" class="'+$.close+'">'+ia.labels.close+"</button>",u+='<span class="'+$.loading_icon+'"></span>',u+='<div class="'+$.container+'">',ia.gallery.active&&ia.thumbnails){u+='<div class="'+[$.thumbnails]+'">',u+='<div class="'+[$.thumbnail_container]+'">';for(var w,x,y=0,z=ia.gallery.$items.length;z>y;y++)w=ia.gallery.$items.eq(y),x=w.data("lightbox-thumbnail"),x||(x=w.find("img").attr("src")),u+='<button class="'+[$.thumbnail_item]+'">',u+='<img src="'+x+'" alt="">',u+="</button>";u+="</div></div>"}u+='<div class="'+$.content+'"></div>',(k||l)&&(u+='<div class="'+$.tools+'">',u+='<div class="'+$.controls+'">',ia.gallery.active&&(u+='<button type="button" class="'+[$.control,$.control_previous].join(" ")+'">'+ia.labels.previous+"</button>",u+='<button type="button" class="'+[$.control,$.control_next].join(" ")+'">'+ia.labels.next+"</button>"),ia.isMobile&&ia.isTouch&&(u+='<button type="button" class="'+[$.toggle,$.caption_toggle].join(" ")+'">'+ia.labels.captionClosed+"</button>",ia.gallery.active&&ia.thumbnails&&(u+='<button type="button" class="'+[$.toggle,$.thumbnail_toggle].join(" ")+'">'+ia.labels.thumbnailsClosed+"</button>")),u+="</div>",u+='<div class="'+$.meta+'">',u+='<div class="'+$.meta_content+'">',ia.gallery.active&&(u+='<p class="'+$.position+'"',ia.gallery.total<1&&(u+=' style="display: none;"'),u+=">",u+='<span class="'+$.position_current+'">'+(ia.gallery.index+1)+"</span> ",u+=ia.labels.count,u+=' <span class="'+$.position_total+'">'+(ia.gallery.total+1)+"</span>",u+="</p>"),u+='<div class="'+$.caption+'">',u+=ia.formatter.call(e,d),u+="</div></div></div>",u+="</div>"),u+="</div></div>",ea.append(u),ia.$overlay=a(Z.overlay),ia.$lightbox=a(Z.base),ia.$close=a(Z.close),ia.$container=a(Z.container),ia.$content=a(Z.content),ia.$tools=a(Z.tools),ia.$meta=a(Z.meta),ia.$metaContent=a(Z.meta_content),ia.$position=a(Z.position),ia.$caption=a(Z.caption),ia.$controlBox=a(Z.controls),ia.$controls=a(Z.control),ia.$thumbnails=a(Z.thumbnails),ia.$thumbnailContainer=a(Z.thumbnail_container),ia.$thumbnailItems=a(Z.thumbnail_item),ia.isMobile?(ia.paddingVertical=ia.$close.outerHeight(),ia.paddingHorizontal=0,ia.mobilePaddingVertical=parseInt(ia.$content.css("paddingTop"),10)+parseInt(ia.$content.css("paddingBottom"),10),ia.mobilePaddingHorizontal=parseInt(ia.$content.css("paddingLeft"),10)+parseInt(ia.$content.css("paddingRight"),10)):(ia.paddingVertical=parseInt(ia.$lightbox.css("paddingTop"),10)+parseInt(ia.$lightbox.css("paddingBottom"),10),ia.paddingHorizontal=parseInt(ia.$lightbox.css("paddingLeft"),10)+parseInt(ia.$lightbox.css("paddingRight"),10),ia.mobilePaddingVertical=0,ia.mobilePaddingHorizontal=0),ia.contentHeight=ia.$lightbox.outerHeight()-ia.paddingVertical,ia.contentWidth=ia.$lightbox.outerWidth()-ia.paddingHorizontal,ia.controlHeight=ia.$controls.outerHeight(),m(),ia.gallery.active&&(ia.$lightbox.addClass($.has_controls),L()),ca.on(_.keyDown,M),da.on(_.focus,V),ea.on(_.click,[Z.overlay,Z.close].join(", "),j),ia.gallery.active&&ia.$lightbox.on(_.click,Z.control,G),ia.thumbnails&&ia.$lightbox.on(_.click,Z.thumbnail_item,H),ia.isMobile&&ia.isTouch&&ia.$lightbox.on(_.click,Z.caption_toggle,o).on(_.click,Z.thumbnail_toggle,r),ia.$lightbox.fsTransition({property:"opacity"},function(){k?t(g):l?D(g):n?P(g):p?N(g):q&&Q(ia.$object)}).addClass($.open),ia.$overlay.addClass($.open)}}function i(a){"object"!=typeof a&&(ia.targetHeight=arguments[0],ia.targetWidth=arguments[1]),"element"===ia.type?R(ia.$content.find("> :first-child")):"image"===ia.type?z():"video"===ia.type&&E(),l()}function j(a){aa.killEvent(a),ia&&(ia.$lightbox.fsTransition("destroy"),ia.$content.fsTransition("destroy"),u(),ia.$lightbox.addClass($.animating).fsTransition({property:"opacity"},function(a){"undefined"!=typeof ia.$inlineTarget&&ia.$inlineTarget.length&&O(),ia.$lightbox.off(_.namespace),ia.$container.off(_.namespace),ca.off(_.keyDown),da.off(_.namespace),ea.off(_.namespace),ia.$overlay.remove(),ia.$lightbox.remove(),ia.$el.focus(),ia=null,ca.trigger(_.close)}),ia.$lightbox.removeClass($.open),ia.$overlay.removeClass($.open),ia.isMobile&&fa.removeClass($.lock))}function k(){var a=n();ia.isMobile?0:ia.duration;ia.isMobile||ia.$controls.css({marginTop:(ia.contentHeight-ia.controlHeight-ia.metaHeight+ia.thumbnailHeight)/2}),""===ia.$caption.html()?(ia.$caption.hide(),ia.$lightbox.removeClass($.has_caption),ia.gallery.active||ia.$tools.hide()):(ia.$caption.show(),ia.$lightbox.addClass($.has_caption)),ia.$lightbox.fsTransition({property:ia.contentHeight!==ia.oldContentHeight?"height":"width"},function(){ia.$content.fsTransition({property:"opacity"},function(){ia.$lightbox.removeClass($.animating),ia.isAnimating=!1}),ia.$lightbox.removeClass($.loading).addClass($.ready),ia.visible=!0,ca.trigger(_.open),ia.gallery.active&&(F(),I(),J()),ia.$lightbox.focus()}),ia.isMobile||ia.$lightbox.css({height:ia.contentHeight+ia.paddingVertical,width:ia.contentWidth+ia.paddingHorizontal,top:ia.fixed?0:a.top});var b=ia.oldContentHeight!==ia.contentHeight||ia.oldContentWidth!==ia.contentWidth;!ia.isMobile&&b||ia.$lightbox.fsTransition("resolve"),ia.oldContentHeight=ia.contentHeight,ia.oldContentWidth=ia.contentWidth,ia.isMobile&&fa.addClass($.lock)}function l(){if(ia.visible&&!ia.isMobile){var a=n();ia.$controls.css({marginTop:(ia.contentHeight-ia.controlHeight-ia.metaHeight+ia.thumbnailHeight)/2}),ia.$lightbox.css({height:ia.contentHeight+ia.paddingVertical,width:ia.contentWidth+ia.paddingHorizontal,top:ia.fixed?0:a.top}),ia.oldContentHeight=ia.contentHeight,ia.oldContentWidth=ia.contentWidth}}function m(){var a=n();ia.$lightbox.css({top:ia.fixed?0:a.top})}function n(){if(ia.isMobile)return{left:0,top:0};var a={left:(b.windowWidth-ia.contentWidth-ia.paddingHorizontal)/2,top:ia.top<=0?(b.windowHeight-ia.contentHeight-ia.paddingVertical)/2:ia.top};return ia.fixed!==!0&&(a.top+=ca.scrollTop()),a}function o(a){if(aa.killEvent(a),ia.captionOpen)p();else{s();var b=parseInt(ia.$metaContent.outerHeight(!0));b+=parseInt(ia.$meta.css("padding-top")),b+=parseInt(ia.$meta.css("padding-bottom")),ia.$meta.css({height:b}),ia.$lightbox.addClass($.caption_open).find(Z.caption_toggle).text(ia.labels.captionOpen),ia.captionOpen=!0}}function p(){ia.$lightbox.removeClass($.caption_open).find(Z.caption_toggle).text(ia.labels.captionClosed),ia.captionOpen=!1}function q(){var a=this.attr("title"),b=void 0!==a&&a?a.replace(/^\s+|\s+$/g,""):!1;return b?'<p class="caption">'+b+"</p>":""}function r(a){aa.killEvent(a),ia.thumbnailsOpen?s():(p(),ia.$lightbox.addClass($.thumbnails_open).find(Z.thumbnail_toggle).text(ia.labels.thumbnailsOpen),ia.thumbnailsOpen=!0)}function s(){ia.$lightbox.removeClass($.thumbnails_open).find(Z.thumbnail_toggle).text(ia.labels.thumbnailsClosed),ia.thumbnailsOpen=!1}function t(b){ia.hasScaled=!1,ia.$imageContainer=a('<div class="'+$.image_container+'"><img></div>'),ia.$image=ia.$imageContainer.find("img"),ia.$image.one(_.load,function(){var a=T(ia.$image);ia.naturalHeight=a.naturalHeight,ia.naturalWidth=a.naturalWidth,ia.retina&&(ia.naturalHeight/=2,ia.naturalWidth/=2),ia.$content.prepend(ia.$imageContainer),z(),k(),ia.touch&&(v(),x({scale:1,deltaX:0,deltaY:0}),y(),ia.$content.fsTouch({pan:!0,scale:!0}).on(_.scaleStart,w).on(_.scaleEnd,y).on(_.scale,x))}).error(S).attr("src",b).addClass($.image),(ia.$image[0].complete||4===ia.$image[0].readyState)&&ia.$image.trigger(_.load)}function u(){ia.$image&&ia.$image.length&&ia.$content.fsTouch("destroy")}function v(){ia.scalePosition=ia.$imageContainer.position(),ia.scaleY=ia.scalePosition.top,ia.scaleX=ia.scalePosition.left,ia.scaleHeight=ia.$image.outerHeight(),ia.scaleWidth=ia.$image.outerWidth()}function w(a){v(),ia.$lightbox.addClass($.scaling)}function x(a){ia.targetContainerY=ia.scaleY+a.deltaY,ia.targetContainerX=ia.scaleX+a.deltaX,ia.targetImageHeight=ia.scaleHeight*a.scale,ia.targetImageWidth=ia.scaleWidth*a.scale,ia.targetImageHeight<ia.scaleMinHeight&&(ia.targetImageHeight=ia.scaleMinHeight),ia.targetImageHeight>ia.scaleMaxHeight&&(ia.targetImageHeight=ia.scaleMaxHeight),ia.targetImageWidth<ia.scaleMinWidth&&(ia.targetImageWidth=ia.scaleMinWidth),ia.targetImageWidth>ia.scaleMaxWidth&&(ia.targetImageWidth=ia.scaleMaxWidth),ia.hasScaled=!0,ia.isScaling=!0,ia.$imageContainer.css({top:ia.targetContainerY,left:ia.targetContainerX}),ia.$image.css({height:ia.targetImageHeight,width:ia.targetImageWidth,top:-(ia.targetImageHeight/2),left:-(ia.targetImageWidth/2)})}function y(a){v(),ia.isScaling=!1;var b=ia.$container.outerHeight()-ia.metaHeight,c=ia.$container.outerWidth();ia.scaleMinY=b-ia.scaleHeight/2,ia.scaleMinX=c-ia.scaleWidth/2,ia.scaleMaxY=ia.scaleHeight/2,ia.scaleMaxX=ia.scaleWidth/2,ia.scaleHeight<b?ia.scalePosition.top=b/2:(ia.scalePosition.top<ia.scaleMinY&&(ia.scalePosition.top=ia.scaleMinY),ia.scalePosition.top>ia.scaleMaxY&&(ia.scalePosition.top=ia.scaleMaxY)),ia.scaleWidth<c?ia.scalePosition.left=c/2:(ia.scalePosition.left<ia.scaleMinX&&(ia.scalePosition.left=ia.scaleMinX),ia.scalePosition.left>ia.scaleMaxX&&(ia.scalePosition.left=ia.scaleMaxX)),ia.$lightbox.removeClass($.scaling),ia.$imageContainer.css({left:ia.scalePosition.left,top:ia.scalePosition.top})}function z(){if(ia.$image){var a=0;for(ia.windowHeight=ia.viewportHeight=b.windowHeight-ia.mobilePaddingVertical-ia.paddingVertical,ia.windowWidth=ia.viewportWidth=b.windowWidth-ia.mobilePaddingHorizontal-ia.paddingHorizontal,ia.contentHeight=1/0,ia.contentWidth=1/0,ia.imageMarginTop=0,ia.imageMarginLeft=0;ia.contentHeight>ia.viewportHeight&&2>a;)ia.imageHeight=0===a?ia.naturalHeight:ia.$image.outerHeight(),ia.imageWidth=0===a?ia.naturalWidth:ia.$image.outerWidth(),ia.metaHeight=0===a?0:ia.metaHeight,ia.spacerHeight=0===a?0:ia.spacerHeight,ia.thumbnailHeight=0===a?0:ia.thumbnailHeight,0===a&&(ia.ratioHorizontal=ia.imageHeight/ia.imageWidth,ia.ratioVertical=ia.imageWidth/ia.imageHeight,ia.isWide=ia.imageWidth>ia.imageHeight),ia.imageHeight<ia.minHeight&&(ia.minHeight=ia.imageHeight),ia.imageWidth<ia.minWidth&&(ia.minWidth=ia.imageWidth),ia.isMobile?(ia.isTouch?(ia.$controlBox.css({width:b.windowWidth}),ia.spacerHeight=ia.$controls.outerHeight(!0)):(ia.$tools.css({width:b.windowWidth}),ia.spacerHeight=ia.$tools.outerHeight(!0)),ia.spacerHeight+=ia.$thumbnails.outerHeight(!0)+10,ia.contentHeight=ia.viewportHeight,ia.contentWidth=ia.viewportWidth,A(),ia.imageMarginTop=(ia.contentHeight-ia.targetImageHeight-ia.spacerHeight)/2,ia.imageMarginLeft=(ia.contentWidth-ia.targetImageWidth)/2):(0===a&&(ia.viewportHeight-=ia.margin+ia.paddingVertical,ia.viewportWidth-=ia.margin+ia.paddingHorizontal),ia.viewportHeight-=ia.metaHeight,ia.thumbnails&&(ia.viewportHeight-=ia.thumbnailHeight),A(),ia.contentHeight=ia.targetImageHeight,ia.contentWidth=ia.targetImageWidth),ia.isMobile||ia.isTouch||ia.$meta.css({width:ia.contentWidth}),ia.hasScaled||(ia.$image.css({height:ia.targetImageHeight,width:ia.targetImageWidth}),ia.touch?ia.$image.css({top:-(ia.targetImageHeight/2),left:-(ia.targetImageWidth/2)}):ia.$image.css({marginTop:ia.imageMarginTop,marginLeft:ia.imageMarginLeft})),ia.isMobile||(ia.metaHeight=ia.$meta.outerHeight(!0),ia.contentHeight+=ia.metaHeight),ia.thumbnails&&(ia.thumbnailHeight=ia.$thumbnails.outerHeight(!0),ia.contentHeight+=ia.thumbnailHeight),a++;ia.touch&&(ia.scaleMinHeight=ia.targetImageHeight,ia.scaleMinWidth=ia.targetImageWidth,ia.scaleMaxHeight=ia.naturalHeight,ia.scaleMaxWidth=ia.naturalWidth)}}function A(){var a=ia.isMobile?ia.contentHeight-ia.spacerHeight:ia.viewportHeight,b=ia.isMobile?ia.contentWidth:ia.viewportWidth;ia.isWide?(ia.targetImageWidth=b,ia.targetImageHeight=ia.targetImageWidth*ia.ratioHorizontal,ia.targetImageHeight>a&&(ia.targetImageHeight=a,ia.targetImageWidth=ia.targetImageHeight*ia.ratioVertical)):(ia.targetImageHeight=a,ia.targetImageWidth=ia.targetImageHeight*ia.ratioVertical,ia.targetImageWidth>b&&(ia.targetImageWidth=b,ia.targetImageHeight=ia.targetImageWidth*ia.ratioHorizontal)),(ia.targetImageWidth>ia.imageWidth||ia.targetImageHeight>ia.imageHeight)&&(ia.targetImageHeight=ia.imageHeight,ia.targetImageWidth=ia.imageWidth),(ia.targetImageWidth<ia.minWidth||ia.targetImageHeight<ia.minHeight)&&(ia.targetImageWidth<ia.minWidth?(ia.targetImageWidth=ia.minWidth,ia.targetImageHeight=ia.targetImageWidth*ia.ratioHorizontal):(ia.targetImageHeight=ia.minHeight,ia.targetImageWidth=ia.targetImageHeight*ia.ratioVertical))}function B(a){return"//www.youtube.com/embed/"+a[1]}function C(a){return"//player.vimeo.com/video/"+a[3]}function D(b){var c=U(b),d=b.split("?");c?(d.length>=2&&(c+="?"+d.slice(1)[0].trim()),ia.$videoWrapper=a('<div class="'+$.video_wrapper+'"></div>'),ia.$video=a('<iframe class="'+$.video+'" frameborder="0" seamless="seamless" allowfullscreen></iframe>'),ia.$video.attr("src",c).addClass($.video).prependTo(ia.$videoWrapper),ia.$content.prepend(ia.$videoWrapper),E(),k()):S()}function E(){ia.windowHeight=ia.viewportHeight=b.windowHeight-ia.mobilePaddingVertical-ia.paddingVertical,ia.windowWidth=ia.viewportWidth=b.windowWidth-ia.mobilePaddingHorizontal-ia.paddingHorizontal,ia.videoMarginTop=0,ia.videoMarginLeft=0,ia.isMobile?(ia.isTouch?(ia.$controlBox.css({width:b.windowWidth}),ia.spacerHeight=ia.$controls.outerHeight(!0)):(ia.$tools.css({width:b.windowWidth}),ia.spacerHeight=ia.$tools.outerHeight(!0)),ia.spacerHeight=ia.$thumbnails.outerHeight(!0)+10,ia.viewportHeight-=ia.spacerHeight,ia.targetVideoWidth=ia.viewportWidth,ia.targetVideoHeight=ia.targetVideoWidth*ia.videoRatio,ia.targetVideoHeight>ia.viewportHeight&&(ia.targetVideoHeight=ia.viewportHeight,ia.targetVideoWidth=ia.targetVideoHeight/ia.videoRatio),ia.videoMarginTop=(ia.viewportHeight-ia.targetVideoHeight)/2,ia.videoMarginLeft=(ia.viewportWidth-ia.targetVideoWidth)/2):(ia.viewportHeight=ia.windowHeight-ia.margin,ia.viewportWidth=ia.windowWidth-ia.margin,ia.targetVideoWidth=ia.videoWidth>ia.viewportWidth?ia.viewportWidth:ia.videoWidth,ia.targetVideoWidth<ia.minWidth&&(ia.targetVideoWidth=ia.minWidth),ia.targetVideoHeight=ia.targetVideoWidth*ia.videoRatio,ia.contentHeight=ia.targetVideoHeight,ia.contentWidth=ia.targetVideoWidth),ia.isMobile||ia.isTouch||ia.$meta.css({width:ia.contentWidth}),ia.$videoWrapper.css({height:ia.targetVideoHeight,width:ia.targetVideoWidth,marginTop:ia.videoMarginTop,marginLeft:ia.videoMarginLeft}),ia.isMobile||(ia.metaHeight=ia.$meta.outerHeight(!0),ia.contentHeight+=ia.metaHeight),ia.thumbnails&&(ia.thumbnailHeight=ia.$thumbnails.outerHeight(!0),ia.contentHeight+=ia.thumbnailHeight)}function F(b){var c="";ia.gallery.index>0&&(c=ia.gallery.$items.eq(ia.gallery.index-1).attr("href"),U(c)||a('<img src="'+c+'">')),ia.gallery.index<ia.gallery.total&&(c=ia.gallery.$items.eq(ia.gallery.index+1).attr("href"),U(c)||a('<img src="'+c+'">'))}function G(b){aa.killEvent(b);var c=a(b.currentTarget);ia.isAnimating||c.hasClass($.control_disabled)||(ia.isAnimating=!0,u(),p(),ia.gallery.index+=c.hasClass($.control_next)?1:-1,ia.gallery.index>ia.gallery.total&&(ia.gallery.index=ia.infinite?0:ia.gallery.total),ia.gallery.index<0&&(ia.gallery.index=ia.infinite?ia.gallery.total:0),I(),ia.$lightbox.addClass($.animating),ia.$content.fsTransition({property:"opacity"},K),ia.$lightbox.addClass($.loading))}function H(b){aa.killEvent(b);var c=a(b.currentTarget);ia.isAnimating||c.hasClass($.active)||(ia.isAnimating=!0,u(),p(),ia.gallery.index=ia.$thumbnailItems.index(c),I(),ia.$lightbox.addClass($.animating),ia.$content.fsTransition({property:"opacity"},K),ia.$lightbox.addClass($.loading))}function I(){if(ia.thumbnails){var a=ia.$thumbnailItems.eq(ia.gallery.index);ia.$thumbnailItems.removeClass($.active),a.addClass($.active)}}function J(){if(ia.thumbnails){var a=ia.$thumbnailItems.eq(ia.gallery.index),b=a.position().left+a.outerWidth(!1)/2-ia.$thumbnailContainer.outerWidth(!0)/2;ia.$thumbnailContainer.stop().animate({scrollLeft:b},200,"linear")}}function K(){"undefined"!=typeof ia.$imageContainer&&ia.$imageContainer.remove(),"undefined"!=typeof ia.$videoWrapper&&ia.$videoWrapper.remove(),ia.$el=ia.gallery.$items.eq(ia.gallery.index),ia.$caption.html(ia.formatter.call(ia.$el,ia)),ia.$position.find(Z.position_current).html(ia.gallery.index+1);var a=ia.$el.attr("href"),b=U(a);b?(ia.type="video",D(a)):(ia.type="image",t(a)),L()}function L(){ia.$controls.removeClass($.control_disabled),ia.infinite||(0===ia.gallery.index&&ia.$controls.filter(Z.control_previous).addClass($.control_disabled),ia.gallery.index===ia.gallery.total&&ia.$controls.filter(Z.control_next).addClass($.control_disabled))}function M(a){!ia.gallery.active||37!==a.keyCode&&39!==a.keyCode?27===a.keyCode&&ia.$close.trigger(_.click):(aa.killEvent(a),ia.$controls.filter(37===a.keyCode?Z.control_previous:Z.control_next).trigger(_.click))}function N(b){ia.$inlineTarget=a(b),ia.$inlineContents=ia.$inlineTarget.children().detach(),Q(ia.$inlineContents)}function O(){ia.$inlineTarget.append(ia.$inlineContents.detach())}function P(b){b+=b.indexOf("?")>-1?"&"+ia.requestKey+"=true":"?"+ia.requestKey+"=true";var c=a('<iframe class="'+$.iframe+'" src="'+b+'"></iframe>');Q(c)}function Q(a){ia.$content.append(a),R(a),k()}function R(a){ia.windowHeight=b.windowHeight-ia.mobilePaddingVertical-ia.paddingVertical,ia.windowWidth=b.windowWidth-ia.mobilePaddingHorizontal-ia.paddingHorizontal,ia.objectHeight=a.outerHeight(!0),ia.objectWidth=a.outerWidth(!0),ia.targetHeight=ia.targetHeight||(ia.$el?ia.$el.data(X+"-height"):null),ia.targetWidth=ia.targetWidth||(ia.$el?ia.$el.data(X+"-width"):null),ia.maxHeight=ia.windowHeight<0?ia.minHeight:ia.windowHeight,ia.isIframe=a.is("iframe"),ia.objectMarginTop=0,ia.objectMarginLeft=0,ia.isMobile||(ia.windowHeight-=ia.margin,ia.windowWidth-=ia.margin),ia.contentHeight=ia.targetHeight?ia.targetHeight:ia.isIframe||ia.isMobile?ia.windowHeight:ia.objectHeight,ia.contentWidth=ia.targetWidth?ia.targetWidth:ia.isIframe||ia.isMobile?ia.windowWidth:ia.objectWidth,(ia.isIframe||ia.isObject)&&ia.isMobile?(ia.contentHeight=ia.windowHeight,ia.contentWidth=ia.windowWidth):ia.isObject&&(ia.contentHeight=ia.contentHeight>ia.windowHeight?ia.windowHeight:ia.contentHeight,ia.contentWidth=ia.contentWidth>ia.windowWidth?ia.windowWidth:ia.contentWidth),ia.isMobile||(ia.contentHeight>ia.maxHeight&&(ia.contentHeight=ia.maxHeight),ia.contentWidth>ia.maxWidth&&(ia.contentWidth=ia.maxWidth))}function S(){var b=a('<div class="'+$.error+'"><p>Error Loading Resource</p></div>');ia.type="element",ia.$tools.remove(),ia.$image.off(_.namespace),Q(b)}function T(a){var b=a[0],c=new Image;return"undefined"!=typeof b.naturalHeight?{naturalHeight:b.naturalHeight,naturalWidth:b.naturalWidth}:"img"===b.tagName.toLowerCase()?(c.src=b.src,{naturalHeight:c.height,naturalWidth:c.width}):!1}function U(a){var b,c=ia.videoFormatter;for(var d in c)if(c.hasOwnProperty(d)&&(b=a.match(c[d].pattern),null!==b))return c[d].format.call(ia,b);return!1}function V(c){var d=c.target;a.contains(ia.$lightbox[0],d)||d===ia.$overlay[0]||(b.killEvent(c),ia.$lightbox.focus())}var W=b.Plugin("lightbox",{widget:!0,defaults:{customClass:"",fileTypes:/\.(jpg|sjpg|jpeg|png|gif)$/i,fixed:!1,formatter:q,infinite:!1,labels:{close:"Close",count:"of",next:"Next",previous:"Previous",captionClosed:"View Caption",captionOpen:"Close Caption",thumbnailsClosed:"View Thumbnails",thumbnailsOpen:"Close Thumbnails"},margin:50,maxHeight:1e4,maxWidth:1e4,minHeight:100,minWidth:100,mobile:!1,retina:!1,requestKey:"fs-lightbox",theme:"fs-light",thumbnails:!1,top:0,touch:!0,videoFormatter:{youtube:{pattern:/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/,format:B},vimeo:{pattern:/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,format:C}},videoRatio:.5625,videoWidth:800},classes:["loading","animating","scaling","fixed","mobile","touch","inline","iframed","open","ready","overlay","close","loading_icon","container","content","image","image_container","video","video_wrapper","tools","meta","meta_content","controls","control","control_previous","control_next","control_disabled","position","position_current","position_total","toggle","caption_toggle","caption","caption_open","thumbnailed","thumbnails_open","thumbnail_toggle","thumbnails","thumbnail_container","thumbnail_item","active","has_controls","has_caption","iframe","error","active","lock"],events:{open:"open",close:"close"},methods:{_setup:c,_construct:e,_destruct:f,_resize:d,resize:i},utilities:{_initialize:g,close:j}}),X=W.namespace,Y=W.defaults,Z=W.classes,$=Z.raw,_=W.events,aa=W.functions,ba=b.window,ca=b.$window,da=b.$document,ea=null,fa=null,ga=!1,ha=!1,ia=null});